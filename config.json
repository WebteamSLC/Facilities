{"id":"e06aa69e-f7f0-4c5a-a9eb-4b18e68c887c","version":"0.12.1","icon":"icon03","splash":"other","splashdata":{"bg":"#ffffff"},"settings":{"router":{"mode":"intelligent","animation":"off"},"theme":"default","push-notifications":{"android":{"enabled":false},"ios":{"enabled":false},"wp":{"enabled":false}},"provisioning":{"enabled":false,"manifest":"","poll":2,"manual":false,"wifionly":true},"crashReporting":{"enabled":false,"androidEnabled":false,"iosEnabled":false,"splunkAndroidApiKey":"","splunkIosApiKey":"","splunkExtraData":""},"kioskMode":{"enabled":false},"logging":{"enabled":false,"bufferFrequency":100,"defaultRootLogLevel":"error","defaultMaxFileSizeKilobyte":1000,"defaultMaxFiles":5,"appEnabled":true,"appUseDefault":true,"appRootLogLevel":"error","appMaxFileSizeKilobyte":1000,"appMaxFiles":5,"clientEnabled":true,"clientUseDefault":true,"clientRootLogLevel":"error","clientMaxFileSizeKilobyte":1000,"clientMaxFiles":5,"nativeEnabled":true,"nativeUseDefault":true,"nativeRootLogLevel":"error","nativeMaxFileSizeKilobyte":1000,"nativeMaxFiles":5},"loading-message":true,"minimise-on-back-button":false,"plugins":{"builtIn":{"cordova-plugin-whitelist@1.2.2":{"override":false,"used":true,"enabled":true},"cordova-plugin-battery-status@1.1.2":{"override":false,"used":false,"enabled":false},"cordova-plugin-console@1.0.3":{"override":false,"used":true,"enabled":true},"cordova-plugin-contacts@2.1.0":{"override":false,"used":false,"enabled":false},"cordova-plugin-device@1.1.2":{"override":false,"used":true,"enabled":true},"cordova-plugin-device-motion@1.2.1":{"override":false,"used":false,"enabled":false},"cordova-plugin-device-orientation@1.0.3":{"override":false,"used":false,"enabled":false},"cordova-plugin-file@4.2.0":{"override":false,"used":true,"enabled":true},"cordova-plugin-geolocation@2.2.0":{"override":false,"used":false,"enabled":false},"cordova-plugin-globalization@1.0.3":{"override":false,"used":true,"enabled":true},"commontime-cordova-plugin-inappbrowser@1.6.2":{"override":false,"used":false,"enabled":false},"cordova-plugin-network-information@1.2.1":{"override":false,"used":false,"enabled":false},"cordova-plugin-splashscreen@3.2.2":{"override":false,"used":true,"enabled":true},"cordova-plugin-vibration@2.1.1":{"override":false,"used":false,"enabled":false},"cordova-plugin-statusbar@1.0.1":{"override":false,"used":true,"enabled":true},"cordova-plugin-camera@2.3.1":{"override":true,"used":true,"enabled":true},"phonegap-plugin-barcodescanner@6.0.4":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.thumbnail@1.4.8":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.fileimporter@1.0.0":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.beacon@1.0.6":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.notification@1.0.11":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.audio@0.9.10":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.media-properties@1.2.11":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.splitscreen@1.1.0":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.preferences@1.0.0":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.authentication@1.0.8":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.urlhandler@1.1.0":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.securesettings@1.0.2":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.geofence@0.5.0":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.file-transfer@1.5.5":{"override":true,"used":false,"enabled":true},"com.commontime.cordova.public.provisioning@0.0.13":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.insomnia@0.0.6":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.splunk-mint@1.0.3":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.kiosk@1.0.11":{"override":false,"used":false,"enabled":false},"cordova-android-movetasktoback@0.1.3":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.logging@1.0.23":{"override":false,"used":true,"enabled":true},"cordova-plugin-email-composer":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.public.messaging@0.0.41":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.file-opener@1.0.8":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.logging@1.0.24":{"override":false,"used":true,"enabled":true},"cordova-plugin-email":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.public.messaging@0.0.44":{"override":false,"used":false,"enabled":false}},"customPlugins":{}}},"language":{"defaultLocale":"en_GB","initialLanguage":"","useDeviceLocale":true},"metadata":{"applicationkey":"cleaningaudit","apiaddress":"https://facilitiestest.southlanarkshire.gov.uk/api/","loginpage":"Home","apisyncinterval":"300000"},"name":"CleaningAudit","packageId":"gov.southlanarkshire.mobile.cleaningaudit","schemaVersion":22,"minimumStudioVersion":"3.1.0","pages":[{"start":true,"name":"Home","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"d68ef2ed-d17e-4811-8a77-0617fe622801","actions":[{"event":"onload","type":"call-api","data":{"sync":false,"name":"default","operation":"failurereasons","params":{"applicationkey":"cleaningaudit"}},"_auto_id_":"d9b55a5d-8b0a-493f-b933-64f37f0a5d05","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"//console.log(cti.store.api.default.failurereasons.data);\n$success();"},"_auto_id_":"e84e4115-5b0e-4995-b38f-23e636cdd603"}]},{"type":"if","data":{},"_auto_id_":"8e6c5c1b-87ab-44b6-934a-8f0d699006a5","operations":[{"type":"value","content":"{{!$store.api.default.schools}}","$selected":false}]},{"event":"onload","type":"call-api","data":{"sync":true,"name":"default","operation":"schools","params":{"applicationkey":"cleaningaudit"}},"_auto_id_":"5eb8ae4d-431a-44aa-8bb8-88d8e59ef1f1","actions":[]},{"event":"onload","type":"call-api","data":{"sync":true,"name":"default","operation":"tasks","params":{"applicationkey":"cleaningaudit"}},"_auto_id_":"e311ff4f-a3c3-49e6-9003-64ec1c8a2f30","actions":[]}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"title","type":"content","item-type":"title","content":"<h1>Facilities Login</h1><p class=\"version\">v. {{'$store.schema.version' | store }}</p>","_auto_id_":"e49fa492-a52a-4da1-b5b4-df98a4c9c0f8"}],"_auto_id_":"3d8e23f8-b06b-49cc-9f3f-c624f15468b6"},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"loginImage","type":"media","item-type":"image-viewer","_auto_id_":"8f614660-db00-4537-a4ed-f9eb87b07aa0","scaleImage":true,"maxWidth":200,"maxHeight":200,"fileName":"SLC-logo 1.svg","expressions":{},"classes":"loginImage","actions":[]},{"name":"username","type":"user-input","item-type":"text","_auto_id_":"daaff33e-6bb8-4b33-b447-d8a961c24a31","label":"Username of the user","required":true,"multiline":false,"debounce":250,"placeholder":"enter your username","validators":[],"expressions":{},"message":"This is a required field","actions":[]},{"name":"school","type":"choice","item-type":"select","_auto_id_":"74162bd3-8251-401f-a20d-e45b7d86035e","label":"Choose school","required":true,"options":[],"expressions":{},"option-source":"$store.api.default.schools.data","value-property":"SCHOOL_ID","label-property":"SCHOOL_NAME","message":"This is a required field","validators":[],"actions":[]},{"name":"password","type":"user-input","item-type":"password","_auto_id_":"a975c204-0dca-46e2-948a-4292eebf08ef","label":"Password","required":true,"left-icon":"fa-lock","message":"This is a required field","expressions":{},"validators":[],"actions":[]},{"name":"btnLogin","type":"button","item-type":"button","_auto_id_":"15e4288c-1d8b-4600-ae48-86118b8d0165","content":"Login","theme":"default","left-icon":"fa-lock","actions":[{"event":"click","type":"inline-function","data":{"sync":false,"code":"application.login(\"login\", \"LoginResponseHandler\");"},"_auto_id_":"d6986081-f74d-4a72-8c24-91b77d24c965","actions":[]}],"expressions":{"disabled":"$form.invalid"},"classes":"loginBtn"}],"_auto_id_":"1d87e933-0a1e-4ee1-9355-728a1953edc8"}]},{"start":false,"name":"Menu","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"1bc20222-aa1d-416f-918f-b6bda646c91e","actions":[{"event":"onload","type":"inline-function","data":{"sync":false,"code":"var d = new Date();\ncti.store.variables.todayDate = d.toLocaleString();"},"_auto_id_":"aabb1371-d439-46e6-ad9f-336c95734421","actions":[]}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"title","type":"content","item-type":"title","content":"<h1>Menu</h1>","_auto_id_":"2344f218-d4f6-4148-a5c6-e76bfd3921ee"}],"_auto_id_":"59a3076f-59aa-4680-b835-09ad1fb667dd"},{"name":"static_1","type":"area","item-type":"static","_auto_id_":"6f932017-d63b-4af6-beb1-2a4e3facf99b","content":[{"name":"html_2","type":"content","item-type":"html","_auto_id_":"e2809b03-4288-4d82-bd07-8c129f7b49d2","content":"<div id=\"time\" style=\"display:none;\">{{'$store.variables.todayDate' | store}}</div>\n<div id=\"schedule\">Schedule: {{'$store.variables.schedule.name' | store }} </div>\n<div id =\"displayName\" style=\"display:none;\">{{'$store.api.default.login.data.displayName' | store}}</div>","expressions":{},"classes":"persDetails"}],"expressions":{},"classes":"statmenu"},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"ScheduledChecks","type":"button","item-type":"nav-button","_auto_id_":"66821042-9eb9-4d27-8237-1a9945dad34e","extends":{"type":"button","item-type":"button"},"content":"Scheduled checks","actions":[{"event":"click","type":"go-to-page","data":{"name":"ScheduledChecks","isConditional":false}}],"expressions":{},"theme":"default","classes":"scheduledBtn"},{"name":"ReactiveChecks","type":"button","item-type":"nav-button","_auto_id_":"20947d0e-0bdc-4eb2-af1a-2d054b60a461","extends":{"type":"button","item-type":"button"},"content":"Reactive checks","actions":[{"event":"click","type":"go-to-page","data":{"name":"ReactiveChecks","isConditional":false}}],"expressions":{},"theme":"default","classes":"reactiveBtn"},{"name":"ChargeableDamage","type":"button","item-type":"nav-button","_auto_id_":"b1b7cb51-d75c-413e-bac1-a64673e75484","extends":{"type":"button","item-type":"button"},"content":"Chargeable damage","actions":[{"event":"click","type":"go-to-page","data":{"name":"ChargeableDamage","isConditional":false}}],"expressions":{},"theme":"default","classes":"chargeableBtn"},{"name":"OutstandingIssues","type":"button","item-type":"nav-button","_auto_id_":"7fe558bc-ea4c-4b55-88cd-58aa789d1b1b","extends":{"type":"button","item-type":"button"},"content":"Outstanding issues","actions":[{"event":"click","type":"go-to-page","data":{"name":"OutstandingIssues","isConditional":false}}],"expressions":{},"theme":"default","classes":"outstandingBtn"},{"name":"LogOut","type":"button","item-type":"button","_auto_id_":"8b717333-313f-497f-8045-46671b46edfe","content":"Log out","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"application.logout();"},"_auto_id_":"26c061ff-2677-46c1-a94f-12f6f5fe7db9"}],"classes":"logoutBtn"}],"_auto_id_":"2b87f76a-a353-4a82-b7bf-e448813bd222","expressions":{},"classes":"menuScroll"}]},{"start":false,"name":"ScheduledChecks","config":[{"name":"On-Load Event","type":"event","item-type":"onload","_auto_id_":"fb91e28d-6818-4d00-8aa5-51c579f21993","actions":[{"event":"onload","type":"search-list","data":{"searchWithin":"custom","page":"ScheduledChecks","list":"list_4","criteria":"{\n  \"id\": \"{{ $store.variables.schedule.id }}\"\n}"},"_auto_id_":"3e0fc652-66ff-4a25-8b0f-e0169430f484"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"button_2","type":"button","item-type":"button","_auto_id_":"d1d46343-e2e8-41d8-89fe-601c26bc8ae1","content":"Back","theme":"default","actions":[{"event":"click","type":"go-back","data":{},"_auto_id_":"b445dc71-16e1-4cc3-b851-4486a7091be6"}],"left-icon":"fa-chevron-left","expressions":{},"classes":"btnTB"},{"name":"title","type":"content","item-type":"title","content":"<h1>Scheduled checks</h1>","_auto_id_":"4c4e0185-3a34-4003-9d8f-979e868c98f9","expressions":{}}],"_auto_id_":"d399648d-da72-4339-b0c8-3abdc3efd017","expressions":{}},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"list_4","type":"content","item-type":"list","_auto_id_":"c27cbb17-9c54-458f-9bc4-dd8379e5e618","static":false,"model":"$store.api.areas.data","data":"[]","autoscroll":false,"search":"external","order":true,"pagination":false,"content":[{"name":"html_5","type":"content","item-type":"html","_auto_id_":"1653fab0-041d-4523-8048-2ffadabc419f","content":"<div class=\"appointment-container actionable status-swatch-{{$data.$item.status||'new'}}\">\n  <div class=\"appointment-column-1\">\n    <div class=\"appointment-time\">{{$data.$item.AREA_NUMBER}}</div>\n  </div>\n  <div class=\"appointment-column-2 item-opener\">\n    <div class=\"appointment-client\">{{$data.$item.AREA_DESCRIPTION}}</div>\n    \n    <div class=\"joblist-description\">{{$data.$item.AREA_FLOOR}}</div>\n    \n    <div class=\"joblist-description\">{{$data.$item.SCHEDULE_ID}}</div>\n  </div>\n</div>","expressions":{}}],"dataSource":"dynamic","searchFunctionExternal":"\nfunction (searchCriteria, item) {\n  return (searchCriteria.id == item.SCHEDULE_ID);\n}","orderProperty":"AREA_NUMBER","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"console.log('You selected ' + JSON.stringify($data.$item));\nconsole.log('You selected ' + $data.$item);\n\ncti.store.variables.currentArea = $data.$item;\n\n//cti.store.variables.failureReasons = \n\ncti.store.variables.areaAuditTasks = cti.store.variables.auditTasks[cti.store.variables.currentArea.AREA_ID];\n\ncti.store.variables.areaFailReasons = cti.store.api.default.failurereasons.data.filter(e => { return e.AREA_TYPE_ID == cti.store.variables.currentArea.AREA_TYPE_ID; })\n\nif (cti.fnSummaryEditable(cti.store.variables.currentArea))\n\t$success();\nelse\n  $fail();\n\n"},"_auto_id_":"3bbaac13-4a71-4d52-addc-f2a70203365e","actions":[{"event":"success","type":"go-to-page","data":{"name":"AreaTasks","isConditional":false},"_auto_id_":"df33322d-b6f3-457c-ad8a-254b92bf1a59"},{"event":"fail","type":"go-to-page","data":{"name":"AreaTaskSummary","isConditional":false},"_auto_id_":"5fb7420d-d950-44d7-84c2-4c7e527a0b58"}]}],"expressions":{}}],"_auto_id_":"90f2070f-a96f-4913-8547-7ad2108bb1bd","expressions":{},"classes":"scheduleChecksScroll"}]},{"start":false,"name":"ReactiveChecks","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"nav_button_1","type":"button","item-type":"nav-button","_auto_id_":"07672f8f-dbe2-4444-87e1-5304e637c2e4","extends":{"type":"button","item-type":"button"},"content":"Back","actions":[{"event":"click","type":"go-to-page","data":{"name":"Menu","isConditional":false}}],"expressions":{},"theme":"default","left-icon":"fa-chevron-left"},{"name":"title","type":"content","item-type":"title","content":"<h1>Reactive checks</h1>","_auto_id_":"fa18689e-783b-48e2-95c8-f06ce29da287"}],"_auto_id_":"399d8a9a-3a99-487b-b663-4f9489a52624","expressions":{}},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"list_4","type":"content","item-type":"list","_auto_id_":"be89ffdd-4d9a-41cb-b2db-c4fc2ff91607","static":false,"model":"$store.api.areas.data","data":"[]","autoscroll":false,"search":"internal","order":true,"pagination":true,"content":[{"name":"html_5","type":"content","item-type":"html","_auto_id_":"e15804a9-afc2-4fe1-b338-b41d42d031b2","content":"<div class=\"appointment-container actionable status-swatch-{{$data.$item.status||'new'}}\">\n  <div class=\"appointment-column-1\">\n    <div class=\"appointment-time\">{{$data.$item.AREA_NUMBER}}</div>\n  </div>\n  <div class=\"appointment-column-2 item-opener\">\n    <div class=\"appointment-client\">{{$data.$item.AREA_DESCRIPTION}}</div>\n    \n    <div class=\"joblist-description\">{{$data.$item.AREA_FLOOR}}</div>\n    \n    <div class=\"joblist-description\">{{$data.$item.SCHEDULE_ID}}</div>\n  </div>\n</div>","expressions":{}}],"dataSource":"dynamic","searchMode":"type","searchDebounce":500,"orderProperty":"AREA_NUMBER","paginationItemsPerPage":10,"paginationBelow":true,"paginationFirstLabel":"First","paginationPrevLabel":"Prev","paginationNextLabel":"Next","paginationLastLabel":"Last","paginationPagesToDisplay":3,"paginationFirstLast":true,"paginationPrevNext":true,"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"console.log('You selected ' + JSON.stringify($data.$item));\nconsole.log('You selected ' + $data.$item);\n\ndebugger;\ncti.store.variables.currentArea = $data.$item;\n\n//cti.store.variables.failureReasons = \n\ncti.store.variables.reactiveTasks = cti.store.variables.auditTasks[cti.store.variables.currentArea.AREA_ID];\n\n// Not have a match, create the audit stub entries for this area on the fly...\nif (cti.store.variables.reactiveTasks === undefined) {\n\n  const tasks = cti.store.api.default.tasks.data;\n  let areaTasks = [];\n  const area = cti.store.variables.currentArea;\n  \n  for (var task of tasks) {\n  \tif (task.AREA_TYPE_ID == area.AREA_TYPE_ID) {\n    \tvar auditTask = JSON.parse(JSON.stringify(task));\n        // Generate a unique internal id we can use to associate photos etc\n        auditTask.internal_id = application.newGuid();\n        auditTask.AREA_ID = area.AREA_ID;\n        auditTask.STATUS_ID = 3; // Default unchecked\n        areaTasks.push(auditTask);\n    }\n  }\n  cti.store.variables.auditTasks[area.AREA_ID] = areaTasks;\n  cti.store.variables.reactiveTasks = areaTasks;\n}\n\ncti.store.variables.areaFailReasons = cti.store.api.default.failurereasons.data.filter(e => { return e.AREA_TYPE_ID == cti.store.variables.currentArea.AREA_TYPE_ID; })\n\nif (cti.fnSummaryEditable(cti.store.variables.currentArea))\n\t$success();\nelse\n  $fail();\n"},"_auto_id_":"c247aa6c-2d98-4beb-86b9-1e07acf43742","actions":[{"event":"success","type":"go-to-page","data":{"name":"ReactiveTasks","isConditional":false},"_auto_id_":"4f59b462-1b9d-468e-aeed-4550d9c50f5c"},{"event":"fail","type":"go-to-page","data":{"name":"AreaTaskSummary","isConditional":false},"_auto_id_":"2168e633-b05d-477f-8b79-d5557ee4d4e3"}]}],"expressions":{}}],"_auto_id_":"78328dac-3d45-46cb-a593-138fd15b6b10","expressions":{},"classes":"reactiveChecksScroll"}]},{"start":false,"name":"ChargeableDamage","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"back","type":"button","item-type":"button","_auto_id_":"23b4aaa6-97c3-4dc5-8723-fe642db9e211","content":"Back","theme":"default","actions":[{"event":"click","type":"go-to-page","data":{"name":"Menu","isConditional":false},"_auto_id_":"b5e0120a-bbbf-47f3-8d9f-7eef566748a1"}],"expressions":{}},{"name":"title","type":"content","item-type":"title","content":"<h1>Chargeable damage</h1>","_auto_id_":"4273ace3-1f6f-47ec-ac9e-7e840bd06b95"}],"_auto_id_":"f8c4e3cc-646d-41bc-9248-ded0366cb45f"},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"list_5","type":"content","item-type":"list","_auto_id_":"8f4877ad-fea2-40c3-a411-a46bebfa8841","static":false,"model":"$store.api.areas.data","data":"[]","autoscroll":false,"search":"internal","order":false,"pagination":false,"content":[{"name":"html_6","type":"content","item-type":"html","_auto_id_":"13fd8f07-9ded-434e-b77e-252a2da5b438","content":"<div class=\"appointment-container actionable status-swatch-{{$data.$item.status||'new'}}\">\n  <div class=\"appointment-column-1\">\n    <div class=\"appointment-time\">{{$data.$item.AREA_NUMBER}}</div>\n  </div>\n  <div class=\"appointment-column-2 item-opener\">\n    <div class=\"appointment-client\">{{$data.$item.AREA_DESCRIPTION}}</div>\n    \n    <div class=\"joblist-description\">{{$data.$item.AREA_FLOOR}}</div>\n    \n    <div class=\"joblist-description\">{{$data.$item.SCHEDULE_ID}}</div>\n  </div>\n</div>"}],"dataSource":"dynamic","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"\n//console.log('You selected ' + JSON.stringify($data.$item));\n//console.log('You selected ' + $data.$item);\n\ncti.store.variables.currentArea = $data.$item;\n\nif (cti.fnSummaryEditable(cti.store.variables.currentArea))\n\t$success();\nelse\n  $fail();"},"_auto_id_":"4c238460-e70b-48f7-a1f9-f44f9e2c5aad","actions":[{"event":"success","type":"go-to-page","data":{"name":"ChargeableRoom","isConditional":false},"_auto_id_":"35642ed7-3b0d-4912-9c75-b878cf142acd"},{"event":"fail","type":"go-to-page","data":{"name":"ChargeableSummary","isConditional":false},"_auto_id_":"3ee0af7b-f65c-4c6a-b517-84ea4b5d4ac6"}]}],"expressions":{},"searchMode":"type","searchDebounce":500}],"_auto_id_":"ef0988c8-b549-4b14-9219-170f1dab49e2"}]},{"start":false,"name":"OutstandingIssues","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"title","type":"content","item-type":"title","content":"<h1>Outstanding issues</h1>","_auto_id_":"93f520af-b311-4ebb-9f11-73df10e2e712"}],"_auto_id_":"b4a0a263-1952-4568-a316-d164d1de4c0b"},{"name":"scrollable","type":"area","item-type":"scrollable","content":[],"_auto_id_":"49564517-313e-48d7-b065-aebdd9349c18"}]},{"start":false,"name":"AreaTasks","config":[{"name":"On-Load Event","type":"event","item-type":"onload","_auto_id_":"10d869b9-bed1-4680-9f8d-4337b028e89d","actions":[]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"button_3","type":"button","item-type":"button","_auto_id_":"8447c5e2-290c-4c70-8a3a-3f154034e2f9","content":"Back","theme":"default","left-icon":"fa-chevron-left","actions":[{"event":"click","type":"go-back","data":{},"_auto_id_":"92674d16-78fa-4003-8f7c-88f1104ba69f"}],"expressions":{},"classes":"btnTB"},{"name":"title","type":"content","item-type":"title","content":"<h1>Tasks</h1>","_auto_id_":"283619de-e763-456c-9a99-41b8341dacd9","expressions":{}},{"name":"button_4","type":"button","item-type":"button","_auto_id_":"837d2412-ac4b-4424-afaa-15af3bf1d608","content":"Save","theme":"default","expressions":{},"actions":[{"event":"click","type":"call-actionflow","data":{"name":"CompleteAudit"},"_auto_id_":"04b3e4f9-97f4-4174-bf76-f249b0f753fe"}],"classes":"topSave","right-icon":"fa-save"}],"_auto_id_":"0460e4f8-8814-4df8-8f7e-a2e16a2ac9d9","expressions":{}},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"button_6","type":"button","item-type":"button","_auto_id_":"b88014e8-e1e0-4dc6-8746-bb5657940f37","content":"Pass all","theme":"default","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"\nfor (var o of cti.store.variables.areaAuditTasks) {\n  o.AUDIT_PASS = 1;\n}\ncti.utils.updatePage();\n"},"_auto_id_":"0be4c96e-2e84-4ed6-a4e9-316b2ee7a804","actions":[]}],"expressions":{},"classes":"btnAllPass"},{"name":"button_7","type":"button","item-type":"button","_auto_id_":"d6b3b062-26ba-4348-a2b0-ba895d5ff611","content":"Valid?","theme":"default","actions":[{"event":"click","type":"call-actionflow","data":{"name":"CompleteAudit"},"_auto_id_":"ddd64117-f9c6-41b9-a2b1-c2ee49d0c342"}],"expressions":{},"classes":"hidden"},{"name":"list_3","type":"content","item-type":"list","_auto_id_":"509aef48-407b-4e3f-a29c-3ce50be359e1","static":false,"model":"$store.variables.areaAuditTasks","data":"[]","autoscroll":false,"search":"","order":false,"pagination":false,"content":[{"name":"html_4","type":"content","item-type":"html","_auto_id_":"91590f24-60ed-4eeb-8982-e7e944be5711","content":"<div class=\"appointment-container actionable status-swatch-{{$data.$item.status||'new'}}\" data-photo-key=\"{{$data.$item.internal_id}}\">\n  \n \n  \n  <div class=\"appointment-column-2 item-opener\">\n    <div class=\"appointment-client\">{{$data.$item.TASK_DESCRIPTION}}</div>\n    \n\n    \n    <div class=\"joblist-description\">{{$data.$item.AREA_ID}}</div>\n  </div>\n</div>\n","expressions":{}},{"name":"AUDIT_PASS","type":"choice","item-type":"radio","_auto_id_":"1bd991c3-cdd3-43dd-a74f-ef5a097ef94d","label":"Item check","required":true,"options":[{"label":"Pass","value":1},{"label":"Fail","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{},"validators":[],"message":"This is a required field","actions":[{"event":"change","type":"set-model","data":{"location":"$data.$item.FAILURE_REASON_ID","value":"undefined"},"_auto_id_":"8a70840f-9017-4e68-9871-19a36b5c1643"}]},{"name":"scrollable_1","type":"area","item-type":"scrollable","_auto_id_":"2f5ed448-fa53-415f-b067-72061c898f1d","content":[{"name":"FAILURE_REASON_ID","type":"choice","item-type":"select","_auto_id_":"ba7941b2-c0c2-47fc-86ff-cf5a8c33b3b6","label":"Failure reason","required":true,"options":[{"label":"Dirty","value":1},{"label":"Broken","value":2},{"label":"Stolen","value":3}],"expressions":{"show":"$data.$item.AUDIT_PASS==0"},"actions":[],"option-source":"$store.variables.areaFailReasons","label-property":"FAILURE_REASON_DESCRIPTION","value-property":"FAILURE_REASON_ID","validators":[],"searchable":false,"message":"This is a required field","classes":"failureDropdown"},{"name":"slcAuditPhoto_1","type":"component","item-type":"web-component","content":[],"componentId":"b41936b4-4a57-43af-a161-2601e9121e68","_auto_id_":"300c8f4a-e7d2-414f-af31-a5e658216a9d","attributes":{"location":"$data.$item.photo"},"expressions":{},"classes":"picButton","actions":[]}],"expressions":{"show":"$data.$item.AUDIT_PASS==0"},"classes":""}],"dataSource":"dynamic","searchFunctionExternal":"function (searchCriteria, item) {\n  return (searchCriteria.AREA_ID == item.AREA_ID);\n}\n","actions":[],"expressions":{},"classes":"taskList"},{"name":"button_10","type":"button","item-type":"button","_auto_id_":"cdef89cf-3f42-4eb4-9ede-aa8bf7637df9","content":"Sample Button","theme":"default","expressions":{"show":"$data.$item.AUDIT_PASS==0"},"left-icon":"fa-camera"}],"_auto_id_":"d253d922-a248-4fa8-b5f5-88c4d5e31ae5","expressions":{}}]},{"start":false,"name":"ReactiveTasks","config":[{"name":"On-Load Event","type":"event","item-type":"onload","_auto_id_":"10d869b9-bed1-4680-9f8d-4337b028e89d","actions":[]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"button_3","type":"button","item-type":"button","_auto_id_":"8447c5e2-290c-4c70-8a3a-3f154034e2f9","content":"Back","theme":"default","left-icon":"fa-chevron-left","actions":[{"event":"click","type":"go-back","data":{},"_auto_id_":"92674d16-78fa-4003-8f7c-88f1104ba69f"}],"expressions":{},"classes":"btnTB"},{"name":"title","type":"content","item-type":"title","content":"<h1>Tasks</h1>","_auto_id_":"283619de-e763-456c-9a99-41b8341dacd9","expressions":{}},{"name":"button_4","type":"button","item-type":"button","_auto_id_":"837d2412-ac4b-4424-afaa-15af3bf1d608","content":"Save","theme":"default","expressions":{},"actions":[{"event":"click","type":"call-actionflow","data":{"name":"CompleteReactive"},"_auto_id_":"04b3e4f9-97f4-4174-bf76-f249b0f753fe"}],"classes":"topSave","right-icon":"fa-save"}],"_auto_id_":"0460e4f8-8814-4df8-8f7e-a2e16a2ac9d9","expressions":{}},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"button_6","type":"button","item-type":"button","_auto_id_":"b88014e8-e1e0-4dc6-8746-bb5657940f37","content":"Pass all","theme":"default","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"\nfor (var o of cti.store.variables.reactiveTasks) {\n  o.AUDIT_PASS = 1;\n}\ncti.utils.updatePage();\n"},"_auto_id_":"0be4c96e-2e84-4ed6-a4e9-316b2ee7a804","actions":[]}],"expressions":{},"classes":"btnAllPass"},{"name":"button_7","type":"button","item-type":"button","_auto_id_":"d6b3b062-26ba-4348-a2b0-ba895d5ff611","content":"Valid?","theme":"default","actions":[{"event":"click","type":"call-actionflow","data":{"name":"CompleteAudit"},"_auto_id_":"ddd64117-f9c6-41b9-a2b1-c2ee49d0c342"}],"expressions":{},"classes":"hidden"},{"name":"list_3","type":"content","item-type":"list","_auto_id_":"509aef48-407b-4e3f-a29c-3ce50be359e1","static":false,"model":"$store.variables.reactiveTasks","data":"[]","autoscroll":false,"search":"","order":false,"pagination":false,"content":[{"name":"html_4","type":"content","item-type":"html","_auto_id_":"91590f24-60ed-4eeb-8982-e7e944be5711","content":"<div class=\"appointment-container actionable status-swatch-{{$data.$item.status||'new'}}\" data-photo-key=\"{{$data.$item.internal_id}}\">\n  \n \n  \n  <div class=\"appointment-column-2 item-opener\">\n    <div class=\"appointment-client\">{{$data.$item.TASK_DESCRIPTION}}</div>\n    \n\n    \n    <div class=\"joblist-description\">{{$data.$item.AREA_ID}}</div>\n  </div>\n</div>\n","expressions":{}},{"name":"AUDIT_PASS","type":"choice","item-type":"radio","_auto_id_":"1bd991c3-cdd3-43dd-a74f-ef5a097ef94d","label":"Item check","required":true,"options":[{"label":"Pass","value":1},{"label":"Fail","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{},"validators":[],"message":"This is a required field","actions":[]},{"name":"FAILURE_REASON_ID","type":"choice","item-type":"select","_auto_id_":"ba7941b2-c0c2-47fc-86ff-cf5a8c33b3b6","label":"Failure reason","required":true,"options":[{"label":"Dirty","value":1},{"label":"Broken","value":2},{"label":"Stolen","value":3}],"expressions":{"show":"$data.$item.AUDIT_PASS==0"},"actions":[],"option-source":"$store.api.default.failurereasons.data","label-property":"FAILURE_REASON_DESCRIPTION","value-property":"FAILURE_REASON_ID","validators":[],"searchable":false,"message":"This is a required field","classes":"failureDropdown"},{"name":"slcAuditPhoto_3","type":"component","item-type":"web-component","content":[],"componentId":"b41936b4-4a57-43af-a161-2601e9121e68","_auto_id_":"34e52880-bb78-4506-8f49-fd7f61dbdd4b"}],"dataSource":"dynamic","searchFunctionExternal":"function (searchCriteria, item) {\n  return (searchCriteria.AREA_ID == item.AREA_ID);\n}\n","actions":[],"expressions":{},"classes":"taskList"}],"_auto_id_":"d253d922-a248-4fa8-b5f5-88c4d5e31ae5","expressions":{}}]},{"start":false,"name":"ChargeableRoom","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"5d7dfee8-0dc5-4f8b-9b2f-0c90c4fc9db0","actions":[{"event":"onloaded","type":"inline-function","data":{"sync":true,"code":"cti.utils.destroyPageData('ChargeableRoom');"},"_auto_id_":"c5a64ac4-9f8f-4883-9890-788c945aadbc"}]},{"name":"On-Load Event","type":"event","item-type":"onload","_auto_id_":"10d869b9-bed1-4680-9f8d-4337b028e89d","actions":[{"event":"onload","type":"call-api","data":{"sync":false,"name":"default","operation":"clients","params":{"applicationkey":"cleaningaudit"}},"_auto_id_":"ed106c1e-71bd-4f88-9699-a7dff35db210","actions":[]},{"event":"onload","type":"call-api","data":{"sync":false,"name":"default","operation":"damageReasons","params":{"applicationkey":"cleaningaudit"}},"_auto_id_":"143b6ef7-5288-4199-9c3e-4d9439eb32bb","actions":[]},{"event":"onload","type":"call-api","data":{"sync":false,"name":"default","operation":"damageareas","params":{"applicationkey":"cleaningaudit"}},"_auto_id_":"f563e5d3-b0dd-42aa-a2f5-c8e4126782b4","actions":[]}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"button_3","type":"button","item-type":"button","_auto_id_":"8447c5e2-290c-4c70-8a3a-3f154034e2f9","content":"Back","theme":"default","left-icon":"fa-chevron-left","actions":[{"event":"click","type":"go-back","data":{},"_auto_id_":"92674d16-78fa-4003-8f7c-88f1104ba69f"}],"expressions":{},"classes":"btnTB"},{"name":"title","type":"content","item-type":"title","content":"<h1>Chargeable room</h1>","_auto_id_":"283619de-e763-456c-9a99-41b8341dacd9","expressions":{}},{"name":"button_4","type":"button","item-type":"button","_auto_id_":"837d2412-ac4b-4424-afaa-15af3bf1d608","content":"Save","theme":"default","expressions":{},"actions":[{"event":"click","type":"call-actionflow","data":{"name":"CompleteDamageAudit"},"_auto_id_":"04b3e4f9-97f4-4174-bf76-f249b0f753fe"}],"classes":"topSave","right-icon":"fa-save"}],"_auto_id_":"0460e4f8-8814-4df8-8f7e-a2e16a2ac9d9","expressions":{}},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"html_7","type":"content","item-type":"html","_auto_id_":"fc389a2e-566b-4f3f-8536-c02e0a88de08","content":"<h2>Room selected</h2>\n<p>Auditor</p>"},{"name":"AreaUser","type":"choice","item-type":"select","_auto_id_":"6f40083c-1049-483e-9d95-4c998c2785c3","label":"Area user","required":true,"options":[{"label":"Option 1","value":1},{"label":"Option 2","value":2},{"label":"Option 3","value":3}],"message":"This is a required field","expressions":{},"option-source":"$store.api.default.clients.data","label-property":"CHARGEABLE_CLIENT_NAME","value-property":"CHARGEABLE_CLIENT_ID","validators":[],"actions":[]},{"name":"DamageReason","type":"choice","item-type":"select","_auto_id_":"8fdb6ff7-fe21-462b-a3df-8e07182b76ce","label":"Failure reason","required":true,"options":[{"label":"Option 1","value":1},{"label":"Option 2","value":2},{"label":"Option 3","value":3}],"expressions":{},"message":"This is a required field","option-source":"$store.api.default.damageReasons.data","label-property":"FAILURE_REASON_DESCRIPTION","value-property":"FAILURE_REASON_ID"},{"name":"DamagedArea","type":"choice","item-type":"select","_auto_id_":"88240431-81f4-49bd-aa7d-66eb270f2df5","label":"Damaged area","required":true,"options":[{"label":"Option 1","value":1},{"label":"Option 2","value":2},{"label":"Option 3","value":3}],"message":"This is a required field","expressions":{},"option-source":"$store.api.default.damageareas.data","label-property":"AREA_DESCRIPTION","value-property":"AREA_ID","validators":[],"actions":[]},{"name":"SpecificLocation","type":"user-input","item-type":"text","_auto_id_":"c652ae06-ae48-4b39-8e16-2f7e65c3c8bc","label":"Specific location","required":false,"multiline":false,"debounce":250,"expressions":{},"actions":[],"validators":[]},{"name":"take_photo_button_1","type":"button","item-type":"take-photo-button","_auto_id_":"16b44c3e-fa98-46bd-9647-add54158d351","extends":{"type":"button","item-type":"button"},"content":"Take photo","actions":[{"event":"click","type":"take-photo","data":{"quality":75,"multiple":false,"mediaId":"my_media"}}],"left-icon":"fa-camera","theme":"default"}],"_auto_id_":"d253d922-a248-4fa8-b5f5-88c4d5e31ae5","expressions":{}}]},{"start":false,"name":"AreaTaskSummary","config":[{"name":"On-Load Event","type":"event","item-type":"onload","_auto_id_":"76f729f1-ac68-4653-bb1d-bb3a6e016542","actions":[]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"button_3","type":"button","item-type":"button","_auto_id_":"fa3fd462-2c6e-4f25-ae56-daaf28bb35ef","content":"Back","theme":"default","left-icon":"fa-chevron-left","actions":[{"event":"click","type":"go-back","data":{},"_auto_id_":"b6e9f869-1ce7-40e4-9382-837960f096ab"}],"expressions":{},"classes":"btnTB"},{"name":"title","type":"content","item-type":"title","content":"<h1>Tasks</h1>","_auto_id_":"9ff803da-3afb-4801-b76b-0599335cb315","expressions":{}}],"_auto_id_":"eea28b07-4a1b-4c2c-a6c8-330c862501f5","expressions":{}},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"list_3","type":"content","item-type":"list","_auto_id_":"2e641f6e-b7db-4c22-ad44-81309d439ede","static":false,"model":"$store.variables.areaAuditTasks","data":"[]","autoscroll":false,"search":"","order":false,"pagination":false,"content":[{"name":"html_4","type":"content","item-type":"html","_auto_id_":"e4092ea2-93ff-49c6-9b0c-3c1a7e37a96b","content":"<div class=\"appointment-container actionable status-swatch-{{$data.$item.status||'new'}}\" data-photo-key=\"{{$data.$item.internal_id}}\">\n  \n \n  \n  <div class=\"appointment-column-2 item-opener\">\n    <div class=\"appointment-client\">{{$data.$item.TASK_DESCRIPTION}}</div>\n    \n\n    \n    <div class=\"joblist-description\">{{$data.$item.AREA_ID}}</div>\n  </div>\n  <div class=\"summary-task-status\">Passed? {{$data.$item.AUDIT_PASS == 0 ? \"FAILED\" : ($data.$item.AUDIT_PASS == 1 ? \"OK\" : \"Not done\" )}}</div>\n  <div class=\"summary-task-status\">Reason? {{$data.$item.FAILURE_REASON_ID ? $data.$item.FAILURE_REASON_ID.label : 'na' }}</div>\n</div>\n"}],"dataSource":"dynamic","searchFunctionExternal":"function (searchCriteria, item) {\n  return (searchCriteria.AREA_ID == item.AREA_ID);\n}\n","actions":[],"expressions":{},"classes":"taskList"}],"_auto_id_":"ce2ca53b-bec3-4c58-9ccb-c89d49c8176e","expressions":{}}]},{"start":false,"name":"ChargeableSummary","config":[{"name":"On-Load Event","type":"event","item-type":"onload","_auto_id_":"53e2d267-9e6f-479c-bc3a-b61fa71223f2","actions":[]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"button_3","type":"button","item-type":"button","_auto_id_":"228249dd-d143-4050-85d8-f89c6817f92d","content":"Back","theme":"default","left-icon":"fa-chevron-left","actions":[{"event":"click","type":"go-back","data":{},"_auto_id_":"007a3aab-19e2-4f87-b29e-4ad437456fc9"}],"expressions":{},"classes":"btnTB"},{"name":"title","type":"content","item-type":"title","content":"<h1>Chargeable Summary</h1>","_auto_id_":"17dd2642-ffe1-43f6-b839-d5a98e54f840","expressions":{}}],"_auto_id_":"b2a326bb-16ea-460c-9767-9074811680e4","expressions":{}},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"html_4","type":"content","item-type":"html","_auto_id_":"f2abfcd5-ef4c-47b7-ad10-777c42cf72ea","content":"<div class=\"appointment-container actionable status-swatch-{{$data.$item.status||'new'}}\" data-photo-key=\"{{$data.$item.internal_id}}\">\n  \n \n  <H1>This area is now complete, summary to follow.</H1>  \n  <!--<div class=\"appointment-column-2 item-opener\">\n    <div class=\"appointment-client\">{{$data.$item.AreaUser}}</div>\n    \n\n    \n    <div class=\"joblist-description\">{{$data.$item.DamageReason}}</div>`\t\n    \n    <div class=\"joblist-description\">{{$data.$item.DamagedArea}}</div>\n    <div class=\"joblist-description\">{{$data.$item.SpecificLocation}}</div>\n  </div>-->\n\n</div>\n","expressions":{}}],"_auto_id_":"666d72a1-e07b-4945-b6f0-181058c2bef6","expressions":{}}]}],"actionflows":[{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var err = undefined;\ndebugger;\nfor (var o of cti.store.variables.areaAuditTasks) {\n  \n  if (o.AUDIT_PASS===undefined) {\n    err = 'Please ensure that you have marked tasks as passed or failed';\n    break;\n  }\n  else if (o.AUDIT_PASS == 0 && o.FAILURE_REASON_ID === undefined) {\n    err = 'Please ensure you specify the reason for any failures';\n    break;\n    \n  }\n}\nif (err) { $fail(err); } else { \n  cti.store.variables.currentArea.status = \"complete\";\n  $success(); \n}\n\n  "},"_auto_id_":"4db8c69f-1c44-4804-95be-6c5cc4e43dd0","actions":[{"event":"fail","type":"show-notification","data":{"options":{"schedule":false,"dynamic":true},"name":"warningMessage","title":"Your audit is not complete","text":"{{$data}}"},"_auto_id_":"1c064433-862a-45f7-99d1-4ec64c54bbca"},{"event":"success","type":"loop","data":{"model":"$store.variables.areaAuditTasks"},"_auto_id_":"5fd989de-7b9b-4127-a7ec-5a89814f43e8","actions":[{"type":"inline-function","data":{"sync":true,"code":"debugger;\nvar item = $data.$item;\nitem.SCHOOL_ID = cti.store.variables.schoolid;\nitem.SCHEDULE_ID = cti.store.variables.schedule.id;\nitem.COMPLETED = new Date();\nif (item.AUDIT_PASS == 0) {\n  item.STATUS_ID = 2; // Fail\n}\nelse {\n  item.STATUS_ID = 1; // pass\n}\nitem.status = \"complete\";\napplication.api(\"saveaudit\", \"POST\", item, \"SaveAuditHandler\", 0);\n$success(item);"},"_auto_id_":"30f70c4e-5a12-4959-9f9d-63cfbce6dd83","actions":[]}]},{"event":"success","type":"go-back","data":{},"_auto_id_":"463b0302-7aff-4dc7-8aeb-270a3647dc34"},{"event":"success","type":"show-notification","data":{"options":{"schedule":false,"dynamic":true},"name":"infoMessage","title":"Save successful","text":"The changes you made have been saved."},"_auto_id_":"29208d91-8e09-499f-88a5-697ae65260f1"}]}],"name":"CompleteAudit"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Was the login request successful?\nif ($data.success) {\n  \n  // Keep track of the school we logged in to work at...\n  cti.store.variables.schoolid= cti.store.pages.Home.school.value;\n  \n  // This is essential - stores our auth token etc where the app framework can find it\n  application.setUserProfile($data.response);\n  \n  // TODO We have the \"happy path\" covered, but what do you want to happen if you log in with an auditTasks list that is partially complete?\n  \n  // Fetch the schedule data...\n  application.api(\"schedules\", \"POST\", { \"schoolid\": cti.store.variables.schoolid }, \"ScdResponseHandler\", -1);\n\n  // Fetch the areas data for this school...\n  application.api(\"areas\", \"POST\", { \"schoolid\": cti.store.variables.schoolid }, \"AreasResponseHandler\", -1);\n  \n  cti.utils.callAction(\"go-to-page\", { \"name\": \"Menu\" });\n}\nelse {\n\tcti.utils.callAction(\"show-notification\", { \"name\": \"ErrorMessage\", \"title\": \"Login failed\", \"text\": $data.error.message });\n}\n"},"_auto_id_":"3002ab3f-13d3-4e70-8576-61457b9a0aa7","actions":[]}],"name":"LoginResponseHandler"},{"content":[{"event":"click","type":"inline-function","data":{"sync":false,"code":"if (!$data.success) {\n\tcti.utils.callAction(\"show-notification\", { \"name\": \"ErrorMessage\", \"title\": \"Schedule not available\", \"text\": $data.error.message });\n}\nelse {\n  debugger;\n  // cti.store.api.schedules\n    var d = new Date();\n    for (var schedule of $data.response.data) {\n\t   \tif (cti.fnIsDateEqual(d, schedule.date)) {\n          cti.store.variables.schedule = schedule;\n          if (cti.store.api.areas) {\n          \tcti.fnCreateScheduleAudits(schedule.id);\n          }\n          break;\n\t\t}\n\t}\n}\n"},"_auto_id_":"cecc1dd1-b1af-4cfa-ad23-fc3c9eb9f808","actions":[]}],"name":"ScdResponseHandler"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"if ($data.success) {\n  // THis will likely happen after the call to get the schedules\n  // so we need to cover both scenarios\n  if (cti.store.api.schedules) {\n    cti.fnCreateScheduleAudits(cti.store.variables.schedule.id);\n  }\n}\n$success();\n"},"_auto_id_":"2ce4a961-7a2f-4d39-9d67-6e0ef596ee92","actions":[]}],"name":"AreasResponseHandler"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"console.log(\"SaveAuditHandler, received: \" + JSON.stringify($data, null, 4));\n\nif (!$data.success && $data.attempts > 2) {\n  \t// Inform the processor we want to stop retrying if, in this case, we tried 10 times without success\n  \t// This essentially generates a permanent failure and can be triggered by whatever criteria you see\n    // sit, in this case, just the number of attempts reached a certain threshhold.\n    // Also, take a look at the actions tab - you'll see we're displaying a notification message if we\n    // deem a permanent failure\n\t$fail({ retry: false, message: \"We were unable to save your audit completion.\" });\n}\n\n$success();"},"_auto_id_":"dce091a1-f279-49a3-a7f0-95c7a0481037","actions":[{"event":"fail","type":"show-notification","data":{"options":{"schedule":false,"dynamic":true},"name":"warningMessage","title":"Failed to complete audit","text":"{{$data.message}}"},"_auto_id_":"089c1da2-43c9-440d-b337-bb68aa5c1e2e"}]}],"name":"SaveAuditHandler"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.currentArea.status = \"complete\";\n$success(); \n\n\n\n  "},"_auto_id_":"1e1d5585-e9c3-4907-89f5-aa1811bbef27","actions":[{"event":"fail","type":"show-notification","data":{"options":{"schedule":false,"dynamic":true},"name":"warningMessage","title":"Your audit is not complete","text":"{{$data}}"},"_auto_id_":"4c8c3ef3-10ef-4b34-8578-baa063be73e0"},{"type":"inline-function","data":{"sync":true,"code":"debugger;\nvar item = {};\nitem.SCHOOL_ID = cti.store.variables.schoolid;\nitem.AREA_ID = cti.store.variables.currentArea.AREA_ID;\nitem.AREA_USER_ID = cti.store.pages.ChargeableRoom.AreaUser.value;\nitem.DAMAGE_AREA_ID = cti.store.pages.ChargeableRoom.DamagedArea.value;\nitem.SPECIFIC_LOCATION = \"aaa\";\nitem.FAILURE_REASON_ID = cti.store.pages.ChargeableRoom.DamageReason.value;\nitem.REPORTED = new Date();\n\napplication.api(\"savedamageaudit\", \"POST\", item, \"SaveDamageHandler\", 0);\n$success(item);\n"},"_auto_id_":"7689e1b4-4a2a-4b7d-9cf9-c7fe2d01fab7","actions":[],"event":"success"},{"event":"success","type":"go-back","data":{},"_auto_id_":"127e12ec-b900-4bc5-bb16-91847f6e045b"},{"event":"success","type":"show-notification","data":{"options":{"schedule":false,"dynamic":true},"name":"infoMessage","title":"Save successful","text":"The changes you made have been saved."},"_auto_id_":"d567d759-8caa-484b-b893-ed86e21eb091"}]}],"name":"CompleteDamageAudit"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"console.log(\"SaveDamageHandler, received: \" + JSON.stringify($data, null, 4));\n\nif (!$data.success && $data.attempts > 2) {\n  \t// Inform the processor we want to stop retrying if, in this case, we tried 10 times without success\n  \t// This essentially generates a permanent failure and can be triggered by whatever criteria you see\n    // sit, in this case, just the number of attempts reached a certain threshhold.\n    // Also, take a look at the actions tab - you'll see we're displaying a notification message if we\n    // deem a permanent failure\n\t$fail({ retry: false, message: \"We were unable to save your audit completion.\" });\n}\n\n$success();"},"_auto_id_":"2a7ec8f1-b996-4d8e-86e4-079568d97b49","actions":[{"event":"fail","type":"show-notification","data":{"options":{"schedule":false,"dynamic":true},"name":"warningMessage","title":"Failed to report damage","text":"{{$data.message}}"},"_auto_id_":"cb826745-a353-4916-be9f-52753d3094fa"}]}],"name":"SaveDamageHandler"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var err = undefined;\ndebugger;\nfor (var o of cti.store.variables.reactiveTasks) {\n  \n  if (o.AUDIT_PASS===undefined) {\n    err = 'Please ensure that you have marked tasks as passed or failed';\n    break;\n  }\n  else if (o.AUDIT_PASS == 0 && o.FAILURE_REASON_ID === undefined) {\n    err = 'Please ensure you specify the reason for any failures';\n    break;\n    \n  }\n}\nif (err) { $fail(err); } else { \n  cti.store.variables.currentArea.status = \"complete\";\n  $success(); \n}\n\n  "},"_auto_id_":"cd786205-68cc-4ed1-a3e2-354605792c91","actions":[{"event":"fail","type":"show-notification","data":{"options":{"schedule":false,"dynamic":true},"name":"warningMessage","title":"Your audit is not complete","text":"{{$data}}"},"_auto_id_":"a5daf0f8-6531-48ad-864a-998433c3dc09"},{"event":"success","type":"loop","data":{"model":"$store.variables.reactiveTasks"},"_auto_id_":"939fef40-6d36-4fc7-8aeb-3a532c706faf","actions":[{"type":"inline-function","data":{"sync":true,"code":"debugger;\nvar item = $data.$item;\nitem.SCHOOL_ID = cti.store.variables.schoolid;\nitem.SCHEDULE_ID = 21;\nitem.COMPLETED = new Date();\nif (item.AUDIT_PASS == 0) {\n  item.STATUS_ID = 2; // Fail\n}\nelse {\n  item.STATUS_ID = 1; // pass\n}\nitem.status = \"complete\";\napplication.api(\"saveaudit\", \"POST\", item, \"SaveAuditHandler\", 0);\n$success(item);"},"_auto_id_":"e45ce097-179e-45a9-94f8-3bf684329c51","actions":[]}]},{"event":"success","type":"go-back","data":{},"_auto_id_":"bc8c9532-f61f-48e1-be7f-0b007b97f3cb"},{"event":"success","type":"show-notification","data":{"options":{"schedule":false,"dynamic":true},"name":"infoMessage","title":"Save successful","text":"The changes you made have been saved."},"_auto_id_":"8788b340-51a1-4a08-abdc-49214e2b77d2"}]}],"name":"CompleteReactive"}],"dataflows":[],"config":[{"name":"css_1","type":"style","item-type":"css","_auto_id_":"157cee3b-6c2a-43c1-a584-89801a5cb30c","content":"/* Overrides for some of the default studio behaviours */\nul li {\n\tlist-style-type:none;\n}\ndiv#AppointmentsList > .main.scrollable {\n    overflow-y: hidden;\n}\na.btn.minimal {\n    color: white!important;\n    font-size: 2em;\n}\n\n.custom-button-bar {\n\tbackground-color:transparent !important;\n}\n.status-button {\n  font-size:1.1em;\n  border-radius:6px;\n  padding:10px 20px;\n  min-width:160px;\n}\n.action-button {\n  font-size:1.1em;\n  border-radius:6px;\n  padding:10px 20px;\n  background-color:transparent !important;\n  min-width:160px;\n}\n\nection#title_bar {\n    color: white;\n    border: 0;\n    box-shadow: 0 5px 10px rgba(0,0,0,0.19), 0 3px 3px rgba(0,0,0,0.23);\n}\nsection#title_bar > div:first-child {\n    position: absolute;\n    left: 0;\n    width: 2em;\n}\nsection#title_bar > div:last-child {\n    position: absolute;\n    right: 2em;\n    width: 2em;\n}\n\n\n/* Appointment card styling */\n.appointment-container {\n    display: flex;\n    margin: 0px 0px 0px 5px;\n    position: relative;\n    border: 1px solid slategray;\n    border-radius: 8px;\n    padding: 6px;\n}\n.appointment-column-1 {\n    flex: 0 0 35px;    \n}\n.appointment-column-2 {\n    flex: 2;\n    margin-left: 12px;\n    justify-content: flex-end;\n}\n.item-opener:after {\n    font-family: 'FontAwesome';\n    content: \"\\f105\";\n    margin-right: 10px;\n    font-size: 34px;\n    float:right;\n    color:#333;    \n}\n.appointment-time {\n  font-size:1.3em;\n  font-weight:700;\n}\n.appointment-date {\n  font-size:0.7em;\n}\n.appointment-client {\n  font-size:1.1em;\n  font-weight:700;\n}\n.appointment-status {\n  text-transform: capitalize;\n  font-weight:700;\n}\n.actionable:hover {\n\tbackground:rgba(205,205,205,0.4)!important;\n  cursor:pointer;\n}\n.actionable:hover > .item-opener:after {\n/*color:green;\ncontent:\"\\f04b\";*/\n  content: \"\\f105\";\n}\n\n\n/* Status swatches at the side of the appointment car */\n.status-swatch-new {\n  border-left:10px solid #35a1df;\n}\n.status-swatch-active {\n  border-left:10px solid #fdcb52;\n}\n.status-swatch-complete {\n  border-left:10px solid #4bd202;\n}\n.status-swatch-cancel {\n  border-left:10px solid #d32a18;\n}\n#schedule {\n\tfloat:right;\n}\n\n/* style */\n\n.page-container {\nbackground-color:#222e66;\n}\n\n\n\n.loginImage img{\n\n    display: block;\n    margin: 0 auto;\n    border: 1px solid #fff;\n    height: auto;\n    margin-top: 30px;\n    margin-bottom: 60px;\n\n}\n\n\n\n.form-group {\n    width: 80%;\n    margin: 0 auto;\n}\n\n\n.form-control {\n    height: 75px;\n      font-size: 18px;\n}\n\n.loginBtn{\nwidth:50%;\nmargin:0 auto;\nmargin-top:60px;\nheight:75px;\nborder-radius:10px;\nline-height:60px;\nfont-size:22px;\ncolor:#222e66;\n}\n\n.navbar-default {\nbackground-color:#222e66;\n\n}\n\n.loader-container {\nbackground-color:#222e66;\ncolor:#fff;\n}\n\nlabel {\n    color: #fff;\n    font-size: 22px;\n}\n\n.scheduledBtn{\n    width: 80%;\n    height: 75px;\n    font-size: 34px;\n    line-height: 60px;\n    text-align: left;\n    background-color: transparent;\n    color: #fff;\n    border: 0;\n    border-bottom: 3px solid;\n}\n.scheduledBtn:hover{background-color: transparent; color:#fff;}\n\n.scheduledBtn:after {\n    font-family: 'FontAwesome';\n    content: \"\\f03a\";\n    margin-right: 10px;\n    font-size: 36px;\n    float: right;\n    color: #fff;\n  \n}\n\n\n.reactiveBtn{\n    width: 80%;\n    height: 75px;\n    font-size: 34px;\n    line-height: 60px;\n    text-align: left;\n    background-color: transparent;\n    color: #fff;\n    border: 0;\n    border-bottom: 3px solid;\n}\n.reactiveBtn:hover{background-color: transparent; color:#fff;}\n\n.reactiveBtn:after {\n    font-family: 'FontAwesome';\n    content: \"\\f046\";\n    margin-right: 10px;\n    font-size: 36px;\n    float: right;\n    color: #fff;\n  \n}\n.chargeableBtn{\n    width: 80%;\n    height: 75px;\n    font-size: 34px;\n    line-height: 60px;\n    text-align: left;\n    background-color: transparent;\n    color: #fff;\n    border: 0;\n    border-bottom: 3px solid;\n}\n.chargeableBtn:hover{background-color: transparent; color:#fff;}\n\n.chargeableBtn:after {\n    font-family: 'FontAwesome';\n    content: \"\\f00d\";\n    margin-right: 10px;\n    font-size: 36px;\n    float: right;\n    color: #fff;\n  \n}\n\n.outstandingBtn{\n    width: 80%;\n    height: 75px;\n    font-size: 34px;\n    line-height: 60px;\n    text-align: left;\n    background-color: transparent;\n    color: #fff;\n    border: 0;\n    border-bottom: 3px solid;\n}\n.outstandingBtn:hover{background-color: transparent; color:#fff;}\n\n.outstandingBtn:after {\n    font-family: 'FontAwesome';\n    content: \"\\f105\";\n    margin-right: 10px;\n    font-size: 36px;\n    float: right;\n    color: #fff;\n  \n}\n.logoutBtn{\n    width: 80%;\n    height: 75px;\n    font-size: 34px;\n    line-height: 60px;\n    text-align: left;\n    background-color: transparent;\n    color: #fff;\n    border: 0;\n    border-bottom: 3px solid;\n}\n\n.logoutBtn:hover{background-color: transparent; color:#fff;}\n\n.logoutBtn:after {\n    font-family: 'FontAwesome';\n    content: \"\\f08b\";\n    margin-right: 10px;\n    font-size: 36px;\n    float: right;\n    color: #fff;\n  \n}\n\n.persDetails{height:150px;}\n.statmenu{height:150px; max-height: 150px;}\n\n.navbar .btn {\n    color: #fff !important;\n    background-color: transparent !important;\n    border: 0;\n    font-size: 20px;\n    margin-left: 15px;\n    margin-right: 15px;\n}\n\n.appointment-container {\n    background-color: #fff;\n    color: #222e66;\n}\n\n.appointment-container:hover {\n    background-color: aliceblue;\n    color: #222e66;\n}\n\n#ScheduledChecks .md-list>.main.scrollable {\n    overflow-y: auto;\n}\n\n#ScheduledChecks ul {\n    margin-top: 0;\n    margin-bottom: 10px;\n    margin: 0;\n    padding: 0;\n    width: 90%;\n    margin: 0 auto;\n}\n\n.appointment-container div{\n    float: left;\n    padding: 10px;\n    font-size: 20px;\n}\n\n.reactiveChecksScroll .md-list>.main.scrollable {\n    overflow-y: auto;\n}\n\n.md-checkbox {\n  color:white;\n}\n\n.taskList.md-list>.main.scrollable {\n    overflow-y: auto;\n}\n\n.taskList ul{\n padding:30px; \n}\n.taskList li{\nbackground-color:#fff;\nmargin-bottom:35px;\nborder-radius: 10px;\n}\n\n.taskList .md-checkbox{\nbackground-color:aliceblue;\ncolor:#222e66;\nmargin-bottom:15px;\nfloat:left;\n}\n\n\n.taskList .appointment-container {\n    display: flex;\n    margin: 0px 0px 0px 0px;\n    position: relative;\n  /*\n    border: 0px solid slategray;\n  */\n    border-radius: 0px;\n    padding: 0px;\n  border-bottom:5px solid slategray;\n}\n\n.taskList .appointment-column-2 {\n    margin-left: 0px;    \n  background-color: #fff;\n}\n\n\n.taskList .form-group {\n    width: 100%;\n   \n}\n\n\n.taskList .md-checkbox-container {\n    text-align: left;\n}\n.taskList .container {\n    width: 100%;\n}\n.taskList .container, .container-fluid {\n    padding-right: 0px; \n    padding-left: 0px;   \n\n}\n\n.taskList .md-checkbox {\n    display: inline-block;\n    padding: 10px 10px 10px 20px;\n    border-radius: 5px;\n    font-size: 16px;\n    line-height: 20px;\n    text-align: left;\n    position: relative;\n    color: #333;\n    cursor: pointer;\n    width: 100%;\n    text-align: center;\n      border: 1px solid;\n    box-shadow: 0px 4px 10px -3px #222e66;\n}\n\n.taskList .checkbox-element {\n    margin: 0 0 0 0;\n    display: inline-block;\n    padding: 0 20px;\n    width: 50%;\n}\n\n.taskList label {\n    color: #222e66;\n    font-size: 22px;\n    margin-left: 20px;\n}\n\n.failureDropdown .form-control{\n  display:block;\n  width:95%; \n  margin: 0 auto;\n}\n\n.taskList .item-opener:after {\n    font-family: 'FontAwesome';\n    content: \"\\f022\";\n    margin-right: 10px;\n    font-size: 34px;\n    float: right;\n    color: #222e66;\n}\n\n.taskList:hover .item-opener:after {\n    font-family: 'FontAwesome';\n    content: \"\\f022\";\n    margin-right: 10px;\n    font-size: 34px;\n    float: right;\n    color: #222e66;\n}\n\n.taskList .fa-star:before {\n    content: \"\\f071\";\n  font-size:15px;\n}\n\n.btnAllPass{\n    height: 60px;\n    font-size: 28px;\n    line-height: 46px;\n    border-radius: 5px;\n    width: 55%;\n    margin-bottom: 32px;\n}\n\n#schedule{\n  display:block;\nfont-size:32px;\ncolor:#fff;\ntext-align:center;\nmargin:0 auto;\n  float:none;\n\n}\n\n.persDetails{\nbackground-color:#222e66;\n  padding :0px;\n}\n\n.static-item{\n background-color:#222e66;\n  border:0;\n}\n.menuScroll{\noverflow-y: auto !important;\n\n}\n\n.topSave{\nmargin-left: 0px !important;\nposition: relative;\nleft: -45px;\n}\n\n.hidden{\ndisplay:none;\n}\n\n.orig{border-left: 10px solid red !important;}\n\n.setOne{border-left: 10px solid green !important;}"},{"name":"infoMessage","type":"notification","item-type":"app-notification","_auto_id_":"ff8f0dca-fe7c-4192-bc36-6995ca9609f0","options":{"autoDismiss":true,"closeButton":true},"style":"info","title":"Information","actions":[]},{"name":"warningMessage","type":"notification","item-type":"app-notification","_auto_id_":"0d6571bc-21d6-4c13-bf3a-45358b67375a","options":{"autoDismiss":true,"closeButton":true},"style":"warning","actions":[]},{"name":"GoogleMapping","type":"integration","item-type":"url","_auto_id_":"0e4c5a4b-dcc0-404e-8093-33c0c3087ce7","params":{},"target":"_system","url":"http://maps.google.co.uk/"},{"name":"default","type":"integration","item-type":"api","_auto_id_":"1dea83e0-e946-4a40-a205-09f494cf097d","headers":{},"params":[],"operations":[{"ttlMinutes":60,"name":"schools","summary":"Get list of schools","path":"schools","method":"POST","content-type":"application/json","params":[{"name":"applicationkey","description":"API key","type":"string","typeConfig":{},"in":"header"}],"$open":true},{"ttlMinutes":60,"name":"login","summary":"Login","path":"login","method":"POST","content-type":"application/json","params":[{"name":"username","description":"User","type":"string","typeConfig":{},"in":"body"},{"name":"password","description":"Password","type":"string","typeConfig":{},"in":"body"},{"name":"applicationkey","description":"API key","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":60,"name":"areas","summary":"Get list of areas","path":"areas","method":"POST","content-type":"application/json","params":[{"name":"applicationkey","description":"API key","type":"string","typeConfig":{},"in":"header"},{"name":"schoolid","description":"ID of school to get areas for","type":"string","typeConfig":{},"in":"body"},{"name":"x-access-token","description":"Auth token","type":"string","typeConfig":{},"in":"header"}],"$open":true},{"ttlMinutes":60,"name":"schedules","summary":"Get schedules","path":"schedules","method":"POST","content-type":"application/json","params":[{"name":"applicationkey","description":"API key","type":"string","typeConfig":{},"in":"header"},{"name":"x-access-token","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"schoolid","description":"School","type":"string","typeConfig":{},"in":"body"}],"$open":true},{"ttlMinutes":60,"name":"tasks","summary":"Retrieve list of tasks","path":"tasks","method":"POST","content-type":"application/json","params":[{"name":"applicationkey","description":"API key","type":"string","typeConfig":{},"in":"header"}],"$open":true},{"ttlMinutes":60,"name":"reactive","path":"reactive","summary":"Get reactive list","method":"POST","content-type":"application/json","$open":true,"params":[{"name":"applicationkey","type":"string","typeConfig":{},"in":"header","description":"API key"}]},{"ttlMinutes":60,"name":"saveaudit","summary":"Save an audit","path":"saveaudit","method":"POST","content-type":"application/json","params":[{"name":"applicationkey","description":"API key","type":"string","typeConfig":{},"in":"header"},{"name":"x-access-token","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"data","description":"New audit payload","type":"string","typeConfig":{},"in":"body"}],"$open":true},{"ttlMinutes":60,"name":"failurereasons","summary":"List of failure reasons","path":"failurereasons","method":"POST","content-type":"application/json","params":[{"name":"applicationkey","description":"API key","type":"string","typeConfig":{},"in":"header"}]},{"ttlMinutes":60,"name":"clients","summary":"list of clients","path":"clients","method":"POST","content-type":"application/json","$open":true,"params":[{"name":"applicationkey","description":"API Key","type":"string","typeConfig":{},"in":"header","required":true}]},{"ttlMinutes":60,"name":"damageReasons","summary":"gets list of damage reasons","path":"damagereasons","method":"POST","content-type":"application/json","$open":true,"params":[{"name":"applicationkey","description":"Application Key","type":"string","typeConfig":{},"in":"header","default":"","required":true}]},{"ttlMinutes":60,"name":"damageareas","summary":"Get list of Damaged Areas","path":"damageareas","method":"POST","content-type":"application/json","params":[{"name":"applicationkey","description":"api key","type":"string","typeConfig":{},"in":"header","required":true}]},{"ttlMinutes":60,"name":"savedamageaudit","summary":"Saves chargeable damage","path":"savedamageaudit","method":"POST","content-type":"application/json","params":[{"name":"applicationkey","description":"API Key","type":"string","typeConfig":{},"in":"header"},{"name":"x-access-token","description":"Auth Token","type":"string","typeConfig":{},"in":"header"},{"name":"data","description":"Data for damaged audit","type":"string","typeConfig":{},"in":"body"}],"$open":true}],"url":"{{$store.schema.metadata.apiaddress}}"},{"name":"fnIsDateEqual","type":"scripting","item-type":"function","_auto_id_":"6d222bd0-b749-4e64-b7ff-73bf1b45be57","sync":true,"params":[{"name":"date1","description":"First date"},{"name":"date2","description":"Second date"}],"content":" var d1 = (typeof date1 === \"string\") ? new Date(date1) : date1;\n var d2 = (typeof date2 === \"string\") ? new Date(date2) : date2;\n return (d1 !== undefined && d2 !== undefined && d1.getFullYear() == d2.getFullYear() && d1.getMonth() == d2.getMonth() && d1.getDate() == d2.getDate());\n"},{"name":"fnCreateScheduleAudits","type":"scripting","item-type":"function","_auto_id_":"d3e4500e-f0d7-4095-bb89-fb57846d5f87","sync":true,"params":[{"name":"scheduleId","description":"Schedule id"}],"content":"var areas = cti.store.api.areas.data;\nvar tasks = cti.store.api.default.tasks.data;\n\nvar auditTasks = { }\n\nvar lastarea = undefined;\n// Go through all areas for our schedule\nfor (var area of areas) {\n  // For each area, go through each task for that area type\n  if (area.SCHEDULE_ID == scheduleId) {\n    var areaTasks = [];\n    // Get any tasks for this area type\n    for (var task of tasks) {\n      if (task.AREA_TYPE_ID == area.AREA_TYPE_ID) {\n        var auditTask = JSON.parse(JSON.stringify(task));\n        // Generate a unique internal id we can use to associate photos etc\n        auditTask.internal_id = application.newGuid();\n        auditTask.AREA_ID = area.AREA_ID;\n        auditTask.STATUS_ID = 3; // Unchecked\n        areaTasks.push(auditTask);\n        //auditTasks.push(auditTask);\n        //auditTasks.push(JSON.parse(JSON.stringify(task)));\n      }\n    }\n    auditTasks[area.AREA_ID] = areaTasks;\n  }\n\n}\ncti.store.variables.auditTasks = auditTasks;","actions":[]},{"name":"ErrorMessage","type":"notification","item-type":"app-notification","_auto_id_":"a111fed5-6ce1-418f-b35f-231f1820d348","options":{"autoDismiss":true,"closeButton":true},"style":"error","title":"An error occured","actions":[]},{"name":"cssForComponents","type":"style","item-type":"css","_auto_id_":"914a75fc-a5d2-48f3-8cb3-ea25f651031c","content":"/*\nFor the ct-loader component - the activity spinner\n*/\n\nct-loader {\n    display:block;\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, 0.7);\n    z-index:10000;\n    display: none;\n}\nct-loader.active {\n  display: block !important;\n}\nct-loader .spinner {\n    height:40px;\n    width:40px;\n    top:20%;\n    margin:auto;\n    animation: rotation 1.2s infinite linear;\n    border-left:6px solid rgba(255,255,255,.8);\n    border-right:6px solid rgba(255,255,255,.8);\n    border-bottom:6px solid rgba(255,255,255,.8);\n    border-top:6px solid rgba(220,79,16,.8);\n    border-radius:100%;\n}  \nct-loader .header {\n    height:25%;\n}\nct-loader .loading-message {\n    padding:10px 20px;\n    text-align:center;\n    font-size:20px;\n    color:white;\n}\n\n@keyframes rotation {\n    from {transform: rotate(0deg);}\n    to {transform: rotate(359deg);}\n}\n\n\n/*\nFor the ct-photomanager component \n*/\n\n#photoArea {\n    margin: 8px 4px;\n    min-height: 20px;\n}\n.photo-row {\n  min-height: 120px;\n  border: 1px solid silver;\n  margin-top: 6px;\n  border-radius:12px;\n  overflow:hidden\n}\n.photo-container {\n  box-sizing:border-box;\n  float:left;\n  width: 25%;\n}\n.photo-container > img {\n    width: 100%;\n    height: auto;\n}\n.photo-info-container {\n  box-sizing:border-box;\n  margin-left:25%;\n  display: block;\n}\n.photo-info-banner {\n  background-color:#dc4f10;\n  min-height:10%;\n  width:100%;\n  text-align:right;\n}\n.photo-info-banner span {\n  position:relative;\n  display:inline-block;\n  color:white;\n  top:25px;\n  height:40px; \n  font-size:0.8em;\n  width:66px;\n  text-align:center;\n}\n.photo-info-banner span:before {\n  font-family: FontAwesome;\n  font-size:2.2em;\n  position:absolute;\n  white-space: pre;\n  top:0px;\n  left: 33px;\n  transform: translate(-12px, -27px);\n}\n.description-option:before {\n  content:\"\\f044\";\n}\n.delete-option:before {\n  content:\"\\f057\";\n}\n.photo-info {\n  float:none;\n  padding:2px;\n  font-size:0.9em;\n}\n.photo-info span {\n  font-size:0.75em;\n  font-weight:700;\n  padding-right:4px;\n}\n.photo-review-container {\n  width:98vw;\n}\n.photo-review {\n  max-width:90%;\n  border:none;\n  height:auto;\n}\n\n.take-photo-div {\n  text-align: center;\n  font-size: 50pt;\n  color: #0072C6!important;\n}\n.take-photo-fa:before {\n  content: \"\\f030\"; \n}\n\n.picButton:before {\n  content: \"\\f030\"; \n}\n\n.picButton{\n    width: 60%;\n    padding: 14px;\n    margin: 0 auto;\n    float: none;\n    display: block;\n    border-radius: 10px;\n    background-color: aliceblue;\n    font-weight: bold;\n    font-size: 20px;\n\n}\n\n.take-photo-button:before {\n  \n  font-family: 'FontAwesome';\n  content: \"\\f030\"; \n  margin-right: 15px;\n}\n\n.take-photo-button{\n    width: 60%;\n    padding: 14px;\n    margin: 0 auto;\n    float: none;\n    display: block;\n    border-radius: 10px;\n    background-color: aliceblue;\n    font-weight: bold;\n    font-size: 20px;\n\n}\n\n"},{"name":"applicationframework","type":"scripting","item-type":"js-asset","_auto_id_":"3b6e7c0b-f099-46fc-8a17-af2619b23a0e","fileName":"framework-application.js"},{"name":"fnReactiveAudits","type":"scripting","item-type":"function","_auto_id_":"623a276e-71af-4ca5-9bce-ae98851992d4","sync":true,"params":[{"name":"Area_ID","required":true}],"content":"var tasks = cti.store.api.default.tasks.data;\nvar areas = cti.store.api.areas.data;\n\nvar lastarea = undefined;\n// Go through all areas for our schedule\nfor (var area of areas) {\n  // For each area, go through each task for that area type\n  if (area.AREA_ID == Area_ID) {\n    var areaTasks = [];\n    // Get any tasks for this area type\n    for (var task of tasks) {\n      if (task.AREA_TYPE_ID == area.AREA_TYPE_ID) {\n        var auditTask = JSON.parse(JSON.stringify(task));\n        // Generate a unique internal id we can use to associate photos etc\n        auditTask.internal_id = application.newGuid();\n        auditTask.AREA_ID = area.AREA_ID;\n        auditTask.STATUS_ID = 3; // Default unchecked\n        areaTasks.push(auditTask);\n        //auditTasks.push(auditTask);\n        //auditTasks.push(JSON.parse(JSON.stringify(task)));\n      }\n    }\n    cti.store.variables.auditTasks[area.AREA_ID] = areaTasks;\n    break;\n  }\n\n}","actions":[]},{"name":"fnSummaryEditable","type":"scripting","item-type":"function","_auto_id_":"2c1df023-1822-438f-8ba3-bb873e89cd4d","sync":true,"params":[{"name":"selectedArea","description":"Area that the user is trying to open"}],"content":"return (!selectedArea.status && selectedArea.status != \"complete\");\n","actions":[]}],"components":[{"name":"ctPhotoManager","description":"Capture and display photos","icon":"fa-puzzle-piece","_auto_id_":"d6068382-4fc2-479c-9e06-841fb463660a","tagName":"ct-photo-manager","type":"web-component","format":"javascript","typeVersion":"1","annotations":{"attributes":[{"name":"captureWidth","description":"Width restriction on captured photos","type":"number","enum":null,"required":false},{"name":"captureHeight","description":"Height restriction on captured photos","type":"number","enum":null,"required":false},{"name":"captureQuality","description":"QUality setting for captured photos","type":"number","enum":["50","75","90","100"],"required":false},{"name":"captureCategory","description":"Optional category identifier to assign to photos when captured.","type":"string","enum":null,"required":false},{"name":"displayCategory","description":"Optional category on which to filter display of photos","type":"string","enum":null,"required":false},{"name":"maxPhotos","description":"Maximum number of photos that can be captured in this category (default is 3)","type":"number","enum":null,"required":false}],"events":[{"name":"captureComplete","description":"Fired when a photo has been captured","type":"void","enum":null},{"name":"editPhoto","description":"Fired when user selects edit option","type":"void","enum":null},{"name":"maxPhotosTaken","description":"Fired when we have taken the maximum number of photos in this category","type":"void","enum":null}],"functions":[{"name":"takePhoto","description":"Take a photo","params":[{"name":"filename","description":"A filename to allocate to the capture photo","type":"string","enum":null,"required":false}],"returnType":"void","returnEnum":null},{"name":"deletePhoto","description":"Delete a photo","params":[{"name":"id","description":"The internal id of the photo to remove","type":"string","enum":null,"required":true}],"returnType":"void","returnEnum":null},{"name":"clearPhotos","description":"Clear photos","params":[],"returnType":"void","returnEnum":null}]},"userConfig":{},"valid":true,"files":{"original":"ctPhotoManager.js","transpiled":"ctPhotoManager.output.js"}},{"name":"slcAuditPhoto","description":"A specific component to allow capturing of a photo in relation to recording the failure reason for an audit entry","icon":"fa-puzzle-piece","_auto_id_":"b41936b4-4a57-43af-a161-2601e9121e68","tagName":"slc-audit-photo","type":"web-component","format":"javascript","typeVersion":"1","annotations":{"attributes":[{"name":"captureWidth","description":"Width restriction on captured photos","type":"number","enum":null,"required":false},{"name":"captureHeight","description":"Height restriction on captured photos","type":"number","enum":null,"required":false},{"name":"captureQuality","description":"QUality setting for captured photos","type":"number","enum":["50","75","90","100"],"required":false}],"events":[{"name":"captureComplete","description":"Fired when a photo has been captured","type":"void","enum":null}],"functions":[{"name":"takePhoto","description":"Take a photo","params":[],"returnType":"void","returnEnum":null}]},"userConfig":{},"valid":true,"files":{"original":"slcAuditPhoto.js","transpiled":"slcAuditPhoto.output.js"}}],"jwt":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJhcHBfaWQiOiJlMDZhYTY5ZS1mN2YwLTRjNWEtYTllYi00YjE4ZTY4Yzg4N2MiLCJhcHBfbmFtZSI6IkNsZWFuaW5nQXVkaXQiLCJidWlsZF9pZCI6ImUyMTUwYTU4LTA0YzgtNDdlYy04NmU5LTlhMTVjYWIxNWQ2MiIsImNsaWVudF9pZCI6Ijk1NjRhZmEwLTg5ZGEtNGYxNC05YjY1LWFkNmRiOTg4ZGMwNCIsImNsaWVudF9zZWNyZXQiOiJhM2hVTkU5V0t6SkhXVUZwTlVsTmRrdERVRFpVZHowOSIsImV4cCI6MTU0MjQ5OTIwMCwiZnJlcXVlbmN5IjoyMTYwMDAwMDAsImhhc2giOiI1Yzk3MTJhNWEyY2I2OTk1NDlhZGJiOGNiOWEwNzA2MDlmMGI3NGZkZDQ2OTNkNjg2YmYwOGNkMjg5ZDM1NTYyIiwibGljX2V4cCI6MTUzOTkwNzIwMCwibHBfaWQiOiIyYmQ3NWE5MC04NTAwLTRlZWUtYTcxNC0yZDdiMDQxN2ZkN2IiLCJwYWNrYWdlX2lkIjoiZ292LnNvdXRobGFuYXJrc2hpcmUubW9iaWxlLmNsZWFuaW5nYXVkaXQiLCJyZWZyZXNoX3Rva2VuIjoiWkM5Tk5IZElSbW95UlZSeWJVbGtSWGxVVldkdmVXZ3ZTMk5pVUVGck4yNUJaa053U3k5UWVXeG5jejA9IiwidHlwZSI6ImZ1bGwiLCJpYXQiOjE1MjIxNDc1MjJ9.qRyFH3j1J4XdNWSQ_nah6awJ-B_DUvXAZ0LiuWuzh1HBtAp2FJ3SXHEkipsojKQFgyl-261er7oTKFy1lRYjB6b_yVkrT3NHh-vb4MkmSRpPKFVwU07qldRA0rKZD0N_omHCqBNP03ATokptlfBWVPpxSBx6BuZ4mj8qGkt6wD3DKR66viP3tZIiDpZYMCQe1bWaJ8tUHw-ywNXdvxkx8Lmd_njk6Pmu8vgfXb-ks7-Y3bITHvdy-JIW11MMCYEKAERxDXBH8n7fGpjzC6_xPrs2ALtRA8RKJX76ncWfMhlqiXHb-ixOKa28klMAwIhavLJM6IIXWpu4OEQ5yEQmKg","buildId":"e2150a58-04c8-47ec-86e9-9a15cab15d62","hostContext":0}